<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>eProbe - Automa√ß√£o Completa</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&family=Genos:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="popup.css" />
</head>

<body>
    <div class="header">
        <h1>
            <img class="icon icon-large" src="iconmain.png" alt="eProbe" />
            eProbe
        </h1>
        <p>Extra√ß√£o e resumo de documentos por IA</p>
    </div>

    <div class="main-container">
        <div class="automation-card">
            <div class="automation-steps">
                <div class="step">
                    <div class="step-number">
                        <svg class="icon icon-small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8" />
                            <path d="m21 21-4.35-4.35" />
                        </svg>
                    </div>
                    <div class="step-text">
                        Detecta documentos na p√°gina
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">
                        <svg class="icon icon-small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M15 3h6v6" />
                            <path d="M10 14 21 3" />
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                        </svg>
                    </div>
                    <div class="step-text">
                        Abre documento automaticamente
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">
                        <svg class="icon icon-small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
                            <polyline points="14,2 14,8 20,8" />
                            <line x1="16" y1="13" x2="8" y2="13" />
                            <line x1="16" y1="17" x2="8" y2="17" />
                            <polyline points="10,9 9,9 8,9" />
                        </svg>
                    </div>
                    <div class="step-text">Extrai texto (HTML/PDF)</div>
                </div>
                <div class="step">
                    <div class="step-number">
                        <svg class="icon icon-small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect width="8" height="4" x="8" y="2" rx="1" ry="1" />
                            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
                        </svg>
                    </div>
                    <div class="step-text">Copia para clipboard</div>
                </div>
                <div class="step">
                    <div class="step-number">
                        <svg class="icon icon-small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z" />
                        </svg>
                    </div>
                    <div class="step-text">Gera resumo via IA</div>
                </div>
            </div>
        </div>

        <div class="buttons">
            <!-- Configura√ß√µes da extens√£o -->
            <div class="settings-area">
                <div class="settings-container">
                    <div class="setting-item">
                        <label class="switch" for="highlight-session-date">
                            <input type="checkbox" id="highlight-session-date" />
                            <span class="slider"></span>
                        </label>
                        <label class="setting-label" for="highlight-session-date">Data da sess√£o em destaque</label>
                    </div>
                    <div class="setting-item">
                        <label class="switch" for="auto-session-requests">
                            <input type="checkbox" id="auto-session-requests" />
                            <span class="slider"></span>
                        </label>
                        <label class="setting-label" for="auto-session-requests">Requisi√ß√µes autom√°ticas de
                            sess√£o</label>
                    </div>
                </div>
            </div>

            <!-- Seletor de Temas -->
            <div class="theme-area">
                <div class="flex justify-center" id="buttons_container">
                    <button data-theme="blue" data-index="0">
                        ""
                    </button>
                    <button data-theme="dark" data-index="1">
                        ""
                    </button>
                    <button data-theme="light" data-index="2">
                        ""
                    </button>
                    <button data-theme="violet" data-index="3">
                        ""
                    </button>
                </div>
            </div>
        </div>

        <div id="status" class="status info hidden">
            <span class="loading-spinner hidden">
                <svg class="icon icon-spinner" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 12a9 9 0 1 1-6.219-8.56" />
                </svg>
            </span>
            <span class="status-text">Aguardando a√ß√£o...</span>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-content">
                <p class="footer-text">
                    <strong>eProbe v1.0.0-beta</strong><br>
                    Alexandre Claudino Simas Santos<br>
                    <small>alexandress@tjsc.jus.br</small>
                </p>
            </div>
        </div>
    </div>

    <script>
        function toggle(index) {
            var buttons = document.getElementById('buttons_container').children;

            // Remove estado ativo de todos os bot√µes
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('text-white');
                buttons[i].classList.remove('underline');
            }

            // Adiciona estado ativo ao bot√£o selecionado
            buttons[index].classList.add('text-white');
            buttons[index].classList.add('underline');

            // Aplica o tema selecionado
            var theme = buttons[index].getAttribute('data-theme');
            console.log('Tema selecionado:', theme);
            applyTheme(theme);
        }

        // Fun√ß√£o para aplicar o tema
        function applyTheme(theme) {
            console.log('üé® POPUP: Iniciando aplica√ß√£o do tema:', theme);

            // Salva a prefer√™ncia do tema
            chrome.storage.sync.set({ selectedTheme: theme }, function () {
                console.log('‚úÖ POPUP: Tema salvo no storage:', theme);
            });

            // Envia mensagem para o content script aplicar o tema
            chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {
                if (tabs[0]) {
                    console.log('üì§ POPUP: Enviando mensagem para tab:', tabs[0].id);
                    chrome.tabs.sendMessage(tabs[0].id, {
                        action: 'applyTheme',
                        theme: theme
                    }, function (response) {
                        if (chrome.runtime.lastError) {
                            console.log('‚ùå POPUP: Erro na comunica√ß√£o:', chrome.runtime.lastError.message);
                        } else {
                            console.log('‚úÖ POPUP: Resposta recebida:', response);
                        }
                    });
                } else {
                    console.log('‚ùå POPUP: Nenhuma aba ativa encontrada');
                }
            });
        }

        // Aplicar tema padr√£o (azul) e carregar tema salvo ao inicializar
        document.addEventListener('DOMContentLoaded', function () {
            console.log('üöÄ POPUP: DOM carregado, configurando event listeners...');

            // Adicionar event listeners para os bot√µes de tema
            var buttons = document.getElementById('buttons_container').children;
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].addEventListener('click', function () {
                    var index = parseInt(this.getAttribute('data-index'));
                    console.log('üñ±Ô∏è POPUP: Bot√£o clicado, √≠ndice:', index, 'tema:', this.getAttribute('data-theme'));
                    toggle(index);
                });
            }
            console.log('‚úÖ POPUP: Event listeners adicionados a', buttons.length, 'bot√µes');

            // Carrega tema salvo ou usa azul como padr√£o
            chrome.storage.sync.get(['selectedTheme'], function (result) {
                var savedTheme = result.selectedTheme || 'blue';
                console.log('üíæ POPUP: Tema salvo encontrado:', savedTheme);

                // Encontra o bot√£o do tema salvo e o ativa
                for (var i = 0; i < buttons.length; i++) {
                    if (buttons[i].getAttribute('data-theme') === savedTheme) {
                        console.log('üéØ POPUP: Ativando tema salvo:', savedTheme, '√≠ndice:', i);
                        toggle(i);
                        break;
                    }
                }

                // Se nenhum tema foi encontrado, ativa o azul (padr√£o)
                if (savedTheme === 'blue') {
                    console.log('üîµ POPUP: Ativando tema padr√£o azul');
                    toggle(0);
                }
            });
        });
    </script>
    <script src="popup.js"></script>
</body>

</html>